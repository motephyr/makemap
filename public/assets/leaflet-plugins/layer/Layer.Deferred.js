L.DeferredLayer=L.LayerGroup.extend({options:{js:[],init:null},_script_cache:{},initialize:function(t){L.Util.setOptions(this,t),L.LayerGroup.prototype.initialize.apply(this),this._loaded=!1},onAdd:function(t){if(L.LayerGroup.prototype.onAdd.apply(this,[t]),!this._loaded){var i=function(){this._loaded=!0;var t=this.options.init();t&&this.addLayer(t)};this._loadScripts(this.options.js.reverse(),L.Util.bind(i,this))}},_loadScripts:function(t,i,e){function a(){r._loadScripts(t,i,e)}if(!t||0===t.length)return i(e);var o,r=this,n=t.pop();if(o=this._script_cache[n],void 0===o){o={url:n,wait:[]};var s=document.createElement("script");s.src=n,s.type="text/javascript",s.onload=function(){o.e.readyState="completed";var t=0;for(t=0;t<o.wait.length;t++)o.wait[t]()},o.e=s,document.getElementsByTagName("head")[0].appendChild(s)}o.wait.push(a),"completed"===o.e.readyState&&a(),this._script_cache[n]=o}});