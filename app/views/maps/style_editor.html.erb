
<% content_for :sidebar_content do %>


<% end %>
<%= render template: "common/sidebar" %>

<%= render template: "common/sidebar_right" %>

<% content_for :javascripts do %>

<script type='text/javascript'>
(function(scope){
    var sidebar = L.control.sidebar('sidebar', {
    position: 'left'
  });

  map.addControl(sidebar);
  sidebar.show();

  var markers = new L.MarkerClusterGroup();

})(window);

var hightlighter;
var editor;

$(window).load(function(){

  // Add 'rh' attribute to element for highlight
  hightlighter = new RegionHighlighter(document.body);

  editor = new StyleEditor({
    renderTo: document.getElementById('float-editor'),
    submitText: 'Save',
    submitClick: function(event, el){
      // $.ajax({
      //   type: "post",
      //   url: url,
      //   data: {
      //     authenticity_token: $('[name=csrf-token]').attr('content'),
      //     _method: 'patch',
      //     map:{
      //       style: JSON.stringify(StyleDropper.suck("se-id"))
      //     }
      //   },
      //   success: function(data, status, xhr){
      //   },
      //   dataType: 'json'
      // });
      $('#style_string').text(JSON.stringify(StyleDropper.suck("se-id")));
      document.getElementById('style_submit_id').click();
    }
  });

  editor.show();


  // hightlighter.onclick(function(o, e){ alert("shit"); });
  
  // hightlighter.addRegion(".leaflet-sidebar #sidebar", {
  //   click: function(o, e){ alert("sidebar left"); }
  // });
  // hightlighter.addRegion(".leaflet-control-container .left .close", {
  //   click: function(o, e){ alert("close left"); }
  // });
  // hightlighter.addRegion(".leaflet-sidebar #sidebar_right", {
  //   click:function(o, e){ alert("sidebar right"); }
  // });
  // hightlighter.addRegion(".leaflet-control-container .right .close", {
  //   click: function(o, e){ alert("close right"); }
  // });

});

</script>
<% end %>
<div id="float-editor">
  <%= simple_form_for @map, :html => { :style => 'display:none' } do |f| %>
  <%= f.input_field :style, as: :text, id: 'style_string' %>
  <%= f.submit '送出', id:'style_submit_id' %>
  <% end %>
</div>
